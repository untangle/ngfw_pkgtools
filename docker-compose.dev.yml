version: '3.8'

services:
  ngfw-pkgtools-dev:
    build:
      context: .
      dockerfile: Dockerfile.dev
    image: ngfw-pkgtools:dev
    container_name: ngfw-pkgtools-dev
    volumes:
      # Mount the current directory to allow live code changes
      - .:/opt/untangle/ngfw_pkgtools
      # Mount git config for authentication
      - ~/.gitconfig:/root/.gitconfig:ro
      # Mount SSH agent socket
      - ${SSH_AUTH_SOCK}:/ssh-agent
    working_dir: /opt/untangle/ngfw_pkgtools
    environment:
      - PYTHONUNBUFFERED=1
      - GERRIT_USER=${GERRIT_USER:-${USER}}
      - SSH_AUTH_SOCK=/ssh-agent
    # Override default CMD to keep container running for interactive use
    command: tail -f /dev/null
